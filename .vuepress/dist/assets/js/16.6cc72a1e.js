(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{342:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"记一次兼容问题处理过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#记一次兼容问题处理过程","aria-hidden":"true"}},[t._v("#")]),t._v(" 记一次兼容问题处理过程")]),t._v(" "),a("h3",{attrs:{id:"场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景","aria-hidden":"true"}},[t._v("#")]),t._v(" 场景")]),t._v(" "),a("p",[t._v("ios9.3.2 app内嵌vue-cli构建的移动端网站")]),t._v(" "),a("h3",{attrs:{id:"现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象","aria-hidden":"true"}},[t._v("#")]),t._v(" 现象")]),t._v(" "),a("p",[t._v("客户反映app点一个按钮跳的页面是空白")]),t._v(" "),a("h3",{attrs:{id:"定位问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定位问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 定位问题")]),t._v(" "),a("p",[t._v("通过沟通确定不是网络问题之后，"),a("br"),t._v("\n让客户用浏览器直接打开我们的网站链接，发现仍然打不开，排除了app的原因。"),a("br"),t._v("\n询问客户系统版本，发现是ios9.3.2,版本较低，考虑是兼容问题"),a("br"),t._v("\n于是用"),a("code",[t._v("xcode")]),t._v("模拟了ios9系统，使用safari打开h5链接，复现了打不开的bug，控制台提示\n"),a("code",[t._v("SyntaxError: Unexpected keyword 'const'. Const declarations are not supported in strict mode.")]),t._v("\n奇怪了 明明用babel转了es6的语法  怎么还出现了"),a("code",[t._v("const")]),t._v(",不过好在问题是锁定了，基本完成了一大步")]),t._v(" "),a("h3",{attrs:{id:"解决问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 解决问题")]),t._v(" "),a("ul",[a("li",[t._v("第一步  查看"),a("code",[t._v("bable")]),t._v("配置,并没有什么不对")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"presets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"modules"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"targets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browsers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"> 1%"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"last 2 versions"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"not ie <= 8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stage-2"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"transform-vue-jsx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"transform-runtime"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"presets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stage-2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"transform-vue-jsx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"istanbul"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("第二步  直接查看webpack打包后的"),a("code",[t._v("app.js")]),t._v(",全局搜索"),a("code",[t._v("const")]),t._v("（注意末尾加空格），发现一个"),a("code",[t._v("const")]),t._v("都没有，"),a("code",[t._v("app.js")]),t._v("也就是业务代码应该是正常转化过了，进一步说明babel工作正常")]),t._v(" "),a("li",[t._v("第三步 找到打包后的"),a("code",[t._v("vendor.js")]),t._v(",重复第二步操作，找到了"),a("code",[t._v("const")]),t._v("！！"),a("code",[t._v("vendor.js")]),t._v("是"),a("code",[t._v("webpack")]),t._v("打包"),a("code",[t._v("node_modules")]),t._v("下的文件后生成的，说明引入了未转化的包，然后在"),a("code",[t._v("node_modules")]),t._v("下搜索"),a("code",[t._v("const")]),t._v("，最终定位在了"),a("code",[t._v("query-string")]),t._v("这个包的源码里")]),t._v(" "),a("li",[t._v("第四步 删除了"),a("code",[t._v("query-string")]),t._v("，去工具库里找了个想同功能的方法代替")]),t._v(" "),a("li",[t._v("第五步 "),a("code",[t._v("xcode")]),t._v("模拟ios9打开网站没有问题，真机ios9测试打开网站没有问题")])]),t._v(" "),a("h3",{attrs:{id:"反思"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反思","aria-hidden":"true"}},[t._v("#")]),t._v(" 反思")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("1、有人反映bug，首先应问清楚具体环境，"),a("code",[t._v("浏览器类型、浏览器版本、系统版本")]),t._v("等等,然后尽可能复现bug，是定位问题的最佳方式"),a("br"),t._v("\n2、引入第三方包需谨慎，默认"),a("code",[t._v("node_modules")]),t._v("下的文件是不会"),a("code",[t._v("babel")]),t._v("处理的")])])])},[],!1,null,null,null);e.options.__file="20180727_npmCompatibleBug.md";s.default=e.exports}}]);