<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>canvas实现小球沿椭圆轨迹运动 | 小浪博客</title>
    <meta name="description" content="肖浪的博客网站,由vuepress驱动,主要记录前端技术">
    <link rel="icon" href="https://avatars3.githubusercontent.com/u/25611177?s=460&amp;v=4">
    
    <link rel="preload" href="/assets/css/0.styles.dfe3e585.css" as="style"><link rel="preload" href="/assets/js/app.d9b1abb2.js" as="script"><link rel="preload" href="/assets/js/2.990adc99.js" as="script"><link rel="preload" href="/assets/js/9.649e1dba.js" as="script"><link rel="prefetch" href="/assets/js/10.5618248a.js"><link rel="prefetch" href="/assets/js/11.c16056e9.js"><link rel="prefetch" href="/assets/js/12.b2393137.js"><link rel="prefetch" href="/assets/js/13.740b6abb.js"><link rel="prefetch" href="/assets/js/14.25f455bb.js"><link rel="prefetch" href="/assets/js/15.7cdf88ec.js"><link rel="prefetch" href="/assets/js/16.2fb29c23.js"><link rel="prefetch" href="/assets/js/17.9b9706cd.js"><link rel="prefetch" href="/assets/js/18.f5906d7c.js"><link rel="prefetch" href="/assets/js/19.8a020d41.js"><link rel="prefetch" href="/assets/js/20.a17164cc.js"><link rel="prefetch" href="/assets/js/21.a128838f.js"><link rel="prefetch" href="/assets/js/22.0b028992.js"><link rel="prefetch" href="/assets/js/23.6196de23.js"><link rel="prefetch" href="/assets/js/24.680b8095.js"><link rel="prefetch" href="/assets/js/25.d44fc7dd.js"><link rel="prefetch" href="/assets/js/26.00a535c2.js"><link rel="prefetch" href="/assets/js/27.f5ea13c6.js"><link rel="prefetch" href="/assets/js/28.a1a2fdbc.js"><link rel="prefetch" href="/assets/js/29.0afc187b.js"><link rel="prefetch" href="/assets/js/3.4492695a.js"><link rel="prefetch" href="/assets/js/30.ae15e959.js"><link rel="prefetch" href="/assets/js/31.1a39d1b6.js"><link rel="prefetch" href="/assets/js/32.c40c0690.js"><link rel="prefetch" href="/assets/js/4.5b888f8d.js"><link rel="prefetch" href="/assets/js/5.ec7c5127.js"><link rel="prefetch" href="/assets/js/6.2e8f283f.js"><link rel="prefetch" href="/assets/js/7.cae66696.js"><link rel="prefetch" href="/assets/js/8.d4585f0c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dfe3e585.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><a href="https://github.com/facexl/facexl.github.io" aria-label="View source on Github" class="github-corner"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" class="octo-arm" style="transform-origin: 130px 106px"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a> <div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/category/all/1.html" class="nav-link">All</a></div><div class="nav-item"><a href="/category/study/1.html" class="nav-link">Study</a></div><div class="nav-item"><a href="/category/practice/1.html" class="nav-link">Practice</a></div><div class="nav-item"><a href="/category/chat/1.html" class="nav-link">Chat</a></div> <div class="avatar-container" data-v-49bef8e6><div class="box" data-v-49bef8e6><div class="bg" data-v-49bef8e6><div class="bg-img" style="background-image:;opacity:0;" data-v-49bef8e6></div> <div id="spinner-detail" data-v-e5a4d2a0 data-v-49bef8e6><div class="xdot1" data-v-e5a4d2a0></div> <div class="xdot2" data-v-e5a4d2a0></div></div></div> <div class="author" data-v-49bef8e6>小浪</div> <div class="desc" data-v-49bef8e6>一个前端</div> <nav class="site-state motion-element" data-v-49bef8e6><div class="site-state-item site-state-posts" data-v-49bef8e6><a href="javascript:;" data-v-49bef8e6><span class="site-state-item-count" data-v-49bef8e6>22</span> <span class="site-state-item-name" data-v-49bef8e6>日志</span></a></div> <div class="site-state-item site-state-categories" data-v-49bef8e6><a href="javascript:;" data-v-49bef8e6><span class="site-state-item-count" data-v-49bef8e6>4</span> <span class="site-state-item-name" data-v-49bef8e6>分类</span></a></div></nav></div></div> <!----></nav> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/category/all/1.html" class="nav-link">All</a></div><div class="nav-item"><a href="/category/study/1.html" class="nav-link">Study</a></div><div class="nav-item"><a href="/category/practice/1.html" class="nav-link">Practice</a></div><div class="nav-item"><a href="/category/chat/1.html" class="nav-link">Chat</a></div> <div class="avatar-container" data-v-49bef8e6><div class="box" data-v-49bef8e6><div class="bg" data-v-49bef8e6><div class="bg-img" style="background-image:;opacity:0;" data-v-49bef8e6></div> <div id="spinner-detail" data-v-e5a4d2a0 data-v-49bef8e6><div class="xdot1" data-v-e5a4d2a0></div> <div class="xdot2" data-v-e5a4d2a0></div></div></div> <div class="author" data-v-49bef8e6>小浪</div> <div class="desc" data-v-49bef8e6>一个前端</div> <nav class="site-state motion-element" data-v-49bef8e6><div class="site-state-item site-state-posts" data-v-49bef8e6><a href="javascript:;" data-v-49bef8e6><span class="site-state-item-count" data-v-49bef8e6>22</span> <span class="site-state-item-name" data-v-49bef8e6>日志</span></a></div> <div class="site-state-item site-state-categories" data-v-49bef8e6><a href="javascript:;" data-v-49bef8e6><span class="site-state-item-count" data-v-49bef8e6>4</span> <span class="site-state-item-name" data-v-49bef8e6>分类</span></a></div></nav></div></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content default"><h3 id="canvas实现小球沿椭圆轨迹运动"><a href="#canvas实现小球沿椭圆轨迹运动" aria-hidden="true" class="header-anchor">#</a> canvas实现小球沿椭圆轨迹运动</h3> <h6 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h6> <p>最近在学习canvas，决定先掌握原生api，再去拥抱让人眼花缭乱的框架</p> <h6 id="效果"><a href="#效果" aria-hidden="true" class="header-anchor">#</a> 效果</h6> <p>希望实现小球以椭圆轨迹绕圆球运动</p> <h6 id="分析"><a href="#分析" aria-hidden="true" class="header-anchor">#</a> 分析</h6> <ul><li>绘制椭圆</li> <li>利用绘制顺序 达到运动过程被遮挡的效果</li></ul> <h5 id="代码"><a href="#代码" aria-hidden="true" class="header-anchor">#</a> 代码</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>



<span class="token keyword">let</span> cas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> ctx <span class="token operator">=</span> cas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> deg <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">180</span>

ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>


<span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    centerX<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//中心点</span>
    centerY<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    bigBallR<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token comment">//大圆半径</span>
    ovalLong<span class="token punctuation">:</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token comment">//椭圆长轴</span>
    ovalShort<span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token comment">//椭圆短轴</span>
    smallBallR<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token comment">//小球半径</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
 * 下半圆
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">drowBallBottom</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span> params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span> params<span class="token punctuation">.</span>bigBallR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#666'</span>
    ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 上半圆
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">drowBallTop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span> params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span> params<span class="token punctuation">.</span>bigBallR<span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#666'</span>
    ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
 * 上半椭圆
 * @param {*} ctx 
 * @param {*} x 中点x
 * @param {*} y 中点y
 * @param {*} a 长轴
 * @param {*} b 短轴
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">drawOvalTop</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>rolateDeg<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

   <span class="token comment">//max是等于1除以长轴值a和b中的较大者</span>
   <span class="token comment">//i每次循环增加1/max，表示度数的增加</span>
   <span class="token comment">//这样可以使得每次循环所绘制的路径（弧线）接近1像素</span>
   <span class="token keyword">var</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>
   context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rolateDeg<span class="token punctuation">)</span>
   <span class="token comment">//context.moveTo(x + a, y); //从椭圆的右端点开始绘制</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> step<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
       
      <span class="token comment">//参数方程为x = a * cos(i), y = b * sin(i)，</span>
      <span class="token comment">//参数为i，表示度数（弧度）</span>
      context<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x <span class="token operator">+</span> a <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">+</span> b <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token punctuation">}</span>
   context<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'#f00'</span>
   context<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>rolateDeg<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment">/**
 * 下半椭圆
 * @param {*} ctx 
 * @param {*} x 中点x
 * @param {*} y 中点y
 * @param {*} a 长轴
 * @param {*} b 短轴
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">drawOvalBottom</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>rolateDeg<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

    <span class="token comment">//max是等于1除以长轴值a和b中的较大者</span>
    <span class="token comment">//i每次循环增加1/max，表示度数的增加</span>
    <span class="token comment">//这样可以使得每次循环所绘制的路径（弧线）接近1像素</span>
    <span class="token keyword">var</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// context.translate(-70,-70);</span>
    context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rolateDeg<span class="token punctuation">)</span>
    <span class="token comment">//context.moveTo(x + a, y); //从椭圆的右端点开始绘制</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>  Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> step<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
       <span class="token comment">//参数方程为x = a * cos(i), y = b * sin(i)，</span>
       <span class="token comment">//参数为i，表示度数（弧度）</span>
       context<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x <span class="token operator">+</span> a <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">+</span> b <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    context<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>rolateDeg<span class="token punctuation">)</span>
    <span class="token comment">//context.translate(70,70);</span>
 
 <span class="token punctuation">}</span>


<span class="token comment">/**
 * 小球
 * @param {*} context 
 * @param {*} x 
 * @param {*} y 
 * @param {*} a 
 * @param {*} b 
 */</span>
<span class="token keyword">function</span> <span class="token function">drawSmallBall</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span>flag<span class="token punctuation">,</span>rolateDeg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment">//max是等于1除以长轴值a和b中的较大者</span>
   <span class="token comment">//i每次循环增加1/max，表示度数的增加</span>
   <span class="token comment">//这样可以使得每次循环所绘制的路径（弧线）接近1像素</span>
   <span class="token keyword">var</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>
   context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rolateDeg<span class="token punctuation">)</span>
   context<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x <span class="token operator">+</span> a<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从椭圆的左端点开始绘制</span>
<span class="token comment">//    for (var i = 0; i &lt; 2 * Math.PI; i += step)</span>
<span class="token comment">//    {</span>
      <span class="token keyword">let</span>  i <span class="token operator">=</span> flag
      <span class="token comment">//参数方程为x = a * cos(i), y = b * sin(i)，</span>
      <span class="token comment">//参数为i，表示度数（弧度）</span>
      ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>x <span class="token operator">+</span> a <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">+</span> b <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>smallBallR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#f00'</span>
      ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//console.log(flag)</span>
      
   <span class="token comment">//}</span>
   context<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   context<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>rolateDeg<span class="token punctuation">)</span>
   

<span class="token punctuation">}</span><span class="token punctuation">;</span>



<span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">&lt;</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token function">drowBallBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">drawOvalBottom</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>flag<span class="token operator">*</span>deg<span class="token punctuation">)</span>
        <span class="token function">drawOvalTop</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>flag<span class="token operator">*</span>deg<span class="token punctuation">)</span>
        <span class="token function">drowBallTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">drawSmallBall</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span>flag<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>flag<span class="token operator">*</span>deg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">)</span> 
        <span class="token function">drawOvalTop</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span>flag<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token operator">*</span>deg<span class="token punctuation">)</span>
        <span class="token function">drawSmallBall</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span>flag<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span>flag<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token operator">*</span>deg<span class="token punctuation">)</span>
        <span class="token function">drowBallBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">drowBallTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">drawOvalBottom</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span>params<span class="token punctuation">.</span>centerY<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalLong<span class="token punctuation">,</span>params<span class="token punctuation">.</span>ovalShort<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span>flag<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token operator">*</span>deg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> step <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">50</span> 


<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">&lt;</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">init</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        flag<span class="token operator">+=</span>step
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        flag <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token function">init</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment">// init(flag)</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre></div><h4 id="demo"><a href="#demo" aria-hidden="true" class="header-anchor">#</a> demo</h4></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/nodejsStudyNote.html" class="prev">
          《深入浅出nodejs》阅读笔记
        </a></span> <span class="next"><a href="/blog/fastClickBug.html">
          fastClick的一个小坑
        </a>
        →
      </span></p></div>  <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d9b1abb2.js" defer></script><script src="/assets/js/2.990adc99.js" defer></script><script src="/assets/js/9.649e1dba.js" defer></script>
  </body>
</html>
